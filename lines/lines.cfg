function linemc(xa, ya, xb, yb)  local m = (ya - yb)/(xa - xb)  return m, ya - m * xaendfunction intersect2mc(ma, ca, mb, cb)  local x = (cb - ca)/(ma - mb)  return x, ma * x + caendfunction intersect2pts(xap, yap, xaq, yaq, xbp, ybp, xbq, ybq)  local ma, ca = linemc(xap, yap, xaq, yaq)  local mb, cb = linemc(xbp, ybp, xbq, ybq)  return intersect2mc(ma, ca, mb, cb)end